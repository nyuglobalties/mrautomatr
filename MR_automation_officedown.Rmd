---
title: "`r params$set_title`"
author: "`r params$set_author`"
date: "`r Sys.Date()`"
params:
  printcode: no
  printwarning: no
  storecache: yes
  set_title: "Lebanon Year 1 (2016-2017) Measurement Report"
  set_author: "Michael Wu"
output: 
  officedown::rdocx_document:
    mapstyles:
      Normal: ['First Paragraph']
    reference_docx: "Template/MR_word_template.docx"
---

```{r setup, include = F}

# knitr global settings
knitr::opts_chunk$set(
  echo = TRUE, 
  fig.cap = TRUE,
  echo = params$printcode, 
  warning = params$printwarning, 
  cache = params$storecache,
  message = F,
  error = T,
  results="asis",
  tab.cap.style = "Table Caption",
  tab.cap.pre = "Table ",
  tab.cap.sep = ": ",
  fig.cap.style = "Image Caption",
  fig.cap.pre = "Figure ",
  fig.cap.sep = ": ")

# packages
library(officedown)
library(officer)
library(tidyverse)
library(psych)
library(MplusAutomation)
library(gridExtra)
library(semPlot)
library(flextable)

fp <- fp_par(
  text.align = "center", 
  padding.bottom = 20, padding.top = 120, 
  border.bottom = fp_border())

ft <- fp_text(shading.color='#EFEFEF', 
              bold = TRUE)

# functions to generate the report
source("R/functions.R")
```

```{r user input, include = F}
user_text <- openxlsx::read.xlsx("Template/input_template.xlsx", sheet = 1)
user_subscale <- openxlsx::read.xlsx("Template/input_template.xlsx", sheet = 2)
user_model <- openxlsx::read.xlsx("Template/input_template.xlsx", sheet = 3)

# create R objects for each variable listed in the excel sheets
for (i in 1:length(user_text)) {
  
  assign(names(user_text)[i], user_text[,i])
  
}

for (i in 1:length(user_subscale)) {
  
  assign(names(user_subscale)[i], user_subscale[,i])
  
}


for (i in 1:length(user_model)) {
  
  assign(names(user_model)[i], user_model[,i])
  
}

# get all the user input vectors
analysis_object <- ls()[sapply(ls(), function(x) class(get(x))) == 'character']

# remove the NAs created by the excel sheets with unequal number of rows for each variable
for (i in 1:length(analysis_object)) {
  assign(
  analysis_object[i], 
  na.omit(eval(as.name(analysis_object[i])))
  )
}

# specify items for each subscale, without wave subscript (ordered by wave)
subscale_data <- BBmisc::convertColsToList(user_subscale)

# a list of all items for the current construct 
subset_data <- as.character(unlist(subscale_data))

# a list of CFA models (ordered by wave)
model_cfa <- split.list(model_cfa, 1)

# a list of treatment invariance models (config, metric and scalar; ordered by wave)
model_inv_tx <- split.list(model_inv_tx, 3)
  
# a list of gender invariance models (config, metric and scalar; ordered by wave)
model_inv_gender <- split.list(model_inv_gender, 3)

# a list of age invariance models (config, metric and scalar; ordered by wave)
model_inv_age <- split.list(model_inv_age, 3)

# the longitudinal invariance model
model_lg_inv <- split.list(model_lg_inv, 1)
```


```{r user input text, include = F}
# year <- "Lebanon Year 1 (2016-2017)"

```

```{r user input data, include = F}
# # file path to the master dataset
# data_file_path <- "~/Box/3EA Analysis/3EA Lebanon_Analysis/Lebanon_Y1_FA/LBY1_PREIMPUTED_FULL_SPREAD_10-31-2019_mplus.dta"
# 
# # specify items for each subscale, without wave subscript (ordered by wave)
# # Hmisc has conflict with psych
# subscale_data <- 
#   list(
#   HAB_1 = Hmisc::Cs(HB1_AB_1, HB2_AB_1, HB3_AB_1, HB4_AB_1, HB5_AB_1, HB6_AB_1),
#   AD_1 = Hmisc::Cs(HB1_AD_1, HB2_AD_1, HB3_AD_1, HB4_AD_1, HB5_AD_1, HB6_AD_1),
#   SD_1 = Hmisc::Cs(HB1_SD_1, HB2_SD_1, HB3_SD_1, HB4_SD_1, HB5_SD_1, HB6_SD_1),
#   AR_1 = Hmisc::Cs(HB1_AR_1, HB2_AR_1, HB3_AR_1, HB4_AR_1, HB5_AR_1, HB6_AR_1),
#   
#   HAB_2 = Hmisc::Cs(HB1_AB_2, HB2_AB_2, HB3_AB_2, HB4_AB_2, HB5_AB_2, HB6_AB_2),
#   AD_2 = Hmisc::Cs(HB1_AD_2, HB2_AD_2, HB3_AD_2, HB4_AD_2, HB5_AD_2, HB6_AD_2),
#   SD_2 = Hmisc::Cs(HB1_SD_2, HB2_SD_2, HB3_SD_2, HB4_SD_2, HB5_SD_2, HB6_SD_2),
#   AR_2 = Hmisc::Cs(HB1_AR_2, HB2_AR_2, HB3_AR_2, HB4_AR_2, HB5_AR_2, HB6_AR_2),
#   
#   HAB_3 = Hmisc::Cs(HB1_AB_3, HB2_AB_3, HB3_AB_3, HB4_AB_3, HB5_AB_3, HB6_AB_3),
#   AD_3 = Hmisc::Cs(HB1_AD_3, HB2_AD_3, HB3_AD_3, HB4_AD_3, HB5_AD_3, HB6_AD_3),
#   SD_3 = Hmisc::Cs(HB1_SD_3, HB2_SD_3, HB3_SD_3, HB4_SD_3, HB5_SD_3, HB6_SD_3),
#   AR_3 = Hmisc::Cs(HB1_AR_3, HB2_AR_3, HB3_AR_3, HB4_AR_3, HB5_AR_3, HB6_AR_3)
#   )
# 
# # a list of all items for the current construct 
# subset_data <- as.character(unlist(subscale_data))
# 
# 
# # file path to all Mplus model outputs
# model_file_path <- "~/Box/For Zezhen/MR automation/Test Data"
# 
# # a list of CFA models (ordered by wave)
# model_cfa <- list("CS1_CFA4.out",
#                "CS2_CFA4.out",
#                "CS3_CFA4.out")
# 
# 
# # a list of treatment invariance models (config, metric and scalar; ordered by wave)
# model_inv_tx <- list(
#   c("CS1_CFA4_tx_inv_config.out",
#     "CS1_CFA4_tx_inv_metric.out",
#     "CS1_CFA4_tx_inv_scalar.out"),
# 
#   c("CS2_CFA4_tx_inv_config.out",
#     "CS2_CFA4_tx_inv_metric.out",
#     "CS2_CFA4_tx_inv_scalar.out"),
# 
#   c("CS3_CFA4_tx_inv_config.out",
#     "CS3_CFA4_tx_inv_metric.out",
#     "CS3_CFA4_tx_inv_scalar.out")
#   )
# 
# # a list of gender invariance models (config, metric and scalar; ordered by wave)
# model_inv_gender <- list(
#   c("CS1_CFA4_Gender_inv_config.out",
#   "CS1_CFA4_Gender_inv_metric.out",
#   "CS1_CFA4_Gender_inv_scalar.out"),
# 
#   c("CS2_CFA4_Gender_inv_config.out",
#   "CS2_CFA4_Gender_inv_metric.out",
#   "CS2_CFA4_Gender_inv_scalar.out"),
# 
#   c("CS3_CFA4_Gender_inv_config.out",
#   "CS3_CFA4_Gender_inv_metric.out",
#   "CS3_CFA4_Gender_inv_scalar.out")
#   )
# 
# # a list of age invariance models (config, metric and scalar; ordered by wave)
# model_inv_age <- list(
#   c("CS1_CFA4_Age_inv_config.out",
#   "CS1_CFA4_Age_inv_metric.out",
#   "CS1_CFA4_Age_inv_scalar.out"),
# 
#   c("CS2_CFA4_Age_inv_config.out",
#   "CS2_CFA4_Age_inv_metric.out",
#   "CS2_CFA4_Age_inv_scalar.out"),
# 
#   c("CS3_CFA4_Age_inv_config.out",
#   "CS3_CFA4_Age_inv_metric.out",
#   "CS3_CFA4_Age_inv_scalar.out")
#   )
# 
# # the longitudinal invariance model
# model_lg_inv <- list(
#   "CS123_CFA4_inv_config.out",
#   "CS123_CFA4_inv_metric.out",
#   "CS123_CFA4_inv_scalar.out"
# )


```

```{r data preparation, include = F}
# read in data (currently accepting dta, xlsx and csv)
dat <- if(grepl(".dta$", data_file_path)){
    haven::read_dta(data_file_path)
} else if(grepl(".xlsx$", data_file_path)){
  openxlsx::read.xlsx(data_file_path)
} else if(grepl(".csv$", data_file_path)){
  read_csv(data_file_path)
}

# subset of only items for the current construct
dat_s <- as.data.frame(select(dat, all_of(subset_data)))

# subscale and its corresponding item names
subscale_item_name <- as.data.frame(subscale_data) %>%
  gather(key = "subscale", value = "item") %>%
  mutate(wave = gsub("(.*)(_)([0-9])", "\\3", subscale),
         wave = paste("T", wave, sep = ""),
         subscale = gsub("(.*)(_)([0-9])", "\\1", subscale)) %>%
  select(subscale, wave, item)

```

\newpage

This document is built using the package `r ftext("officedown", ft)`. 
`r fp`

## Table of content

<!---BLOCK_TOC--->

## List of figures

<!---BLOCK_TOC{seq_id: 'fig'}--->

## List of tables

<!---BLOCK_TOC{seq_id: 'tab'}--->


\newpage


## Data and Sample

This report presents descriptive and psychometric information of the measures used for `r year`.

\newpage

## Method

TBD...

\newpage

## Results

### Descriptive Statistics

see Table \@ref(tab:descriptive).

```{r descriptive, tab.cap="Descriptive statistics", tab.id = "descriptive"}
ds <- skimr::skim(dat_s) %>% 
  mutate_if(is.numeric, round, 3) %>%
  rename_with( ~ gsub("^(numeric.)(.*)$", "\\2", .x), starts_with("numeric.")) %>%
  select(-skim_type, -hist) %>%
  rename(variable = skim_variable)
  

flextable(ds) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>% 
  bold(part = "header") %>%
  italic(j = 6:10, part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  line_spacing(space = 1) %>%
  set_table_properties(layout = "autofit")


```

\newpage
```{r ds_plot, fig.cap = "Item distribution",fig.id = "ds_plot", fig.height = 8, fig.width = 6, dpi = 300}

# descriptive plots

par(mfrow = c(6,6),
    mar = c(4,1,1,1))

chunk_num <- ncol(dat_s) %/% 24

while (chunk_num >= 1) {
  for (i in 1:24) {
    index <- 24*(chunk_num - 1) + i

    hist(dat_s[, index], main = "", xlab = names(dat_s)[index], col = "white")
  }

  chunk_num <- chunk_num - 1
}

  
```

\newpage


<!---BLOCK_LANDSCAPE_START--->
```{r correlation_matrix, tab.cap = "Correlation matrix", tab.id = "correlation_matrix"}
# Correlation matrix

df_cor <- sup.cat(get.cor(model = model_lg_inv[[3]], # the third item should be the scalar model
             string = ".WITH$"))

df_cor <- df_cor %>%
            rownames_to_column("variable") %>%
            rename(" " = variable)

flextable(df_cor) %>%
  add_footer_row(values = "* p < 0.05. ** p < 0.01. *** p < 0.001.", 
                  colwidths =  ncol(df_cor)) %>%
  align(part = "all") %>% 
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  bold(j = " ", part = "body") %>%
  fontsize(size = 10, part = "all") %>% 
  italic(part = "footer") %>%
  set_table_properties(layout = "autofit")
```

\newpage

### Factor Analysis

#### EFA and CFA
```{r EFA screeplot, fig.height = 4, fig.width = 12}
# EFA screeplot: pending for now

# EFA <- readModels(file.path(model_file_path,"CS1_EFA.out"))
# 
# # For now, you can manually set up a spreadsheet and we can work from that spreadsheet in r
# efa <- read.csv("Eigenvector check.csv", as.is  = T)
# 
# efa$wave <- as.factor(efa$wave)
# efa$wave <- factor(efa$wave,levels(efa$wave)[c(1,3,2)])
# 
# efa.s <- filter(efa, measure == "CS")
# p <- ggplot(efa.s, aes(x = factor, y = eigenvalue)) +
#   geom_point() +
#   geom_line() +
#   scale_x_continuous(breaks = seq(0, max(efa.s$factor), by = 2)) +
#   facet_wrap(~ wave) +
#   labs(x = "\nComponent Number", y = "Eigenvalue\n", title = "Figure X. Scree plots") + theme_classic();p
```

```{r, cfa_model_fit, tab.cap = "CFA model fits at all waves", tab.id = "cfa_model_fit"}

df_cfa <- sup.cat(map_dfr(lapply(model_cfa, get.fit),bind_rows))

flextable(df_cfa) %>%
    compose(
    part = "header", j = "ChiSq",
    value = as_paragraph("\U03C7",as_sup("2"))
    ) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  italic(j = 4, part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")

```

\newpage
```{r, cfa_model_plot, fig.cap = "CFA model final factor structure", fig.id = "cfa_model_plot", fig.height = 4, fig.width = 8, fig.align='center', dpi = 300}

plot_label <- sup.cat(map_dfc(lapply(model_cfa, get.est), bind_cols)) %>%
  unite("label", everything(), sep = "")

model_cfa_str <- sup.cat(readModels(file.path(model_file_path, model_cfa[[1]])))

par(mfrow = c(1,1))
semPaths(model_cfa_str, style="lisrel", layout = "tree",
         nCharNodes = 5, sizeMan = 4, sizeMan2 = 4, sizeLat = 8, 
         thresholds = F, residuals = F, intercepts = F, edge.color = "gray40", edgeLabels = plot_label$label, edge.label.cex = 0.3,edge.label.position = 0.8, label.cex = 1, mar=c(1,1,3,1))

```

\newpage

```{r CFA_model_parameters, tab.cap = "CFA model parameters at all waves", tab.id = "CFA_model_parameters"}
df_cfa_modparam <- sup.cat(lapply(model_cfa, get.modparam) %>% 
  reduce(left_join, by = c("paramHeader", "param")))

flextable(df_cfa_modparam) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")
```

\newpage

```{r cfa_r2, tab.cap = "CFA model R-squared at all waves", tab.id = "CFA_r2"}

df_cfa_r2 <- sup.cat(lapply(model_cfa, get.R2)) %>% 
  reduce(left_join, by = c("param"))

flextable(df_cfa_r2) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")

```

\newpage

#### Internal Reliability and Correlations


```{r internal_reliability, tab.cap = "Internal reliability by each subscale", tab.id = "internal_reliability"}

# (example: https://rpubs.com/hauselin/reliabilityanalysis)

# ## under development..
# index <- as.numeric(unique(gsub("^(.*)(\\d)$", "\\2",names(dat_s))))
# 
# alpha_list <- list()
# 
# for (i in index) {
#   
#   alpha_list[[i]] <- select(dat_s, ends_with(as.character(i)))
#   
# }
# 
# ###

alpha_drop = list()

for(i in 1:length(subscale_data)){
  
 alpha_drop[[i]] <- alpha(select(dat_s, all_of(subscale_data[[i]])))$alpha.drop
  
}

alpha_drop <- map_dfr(alpha_drop, bind_rows) %>% 
            round(digits = 3) %>%
            rownames_to_column("item") %>%
  left_join(subscale_item_name, by = "item") %>%
  select(subscale, wave, everything())

alpha_drop <- as_grouped_data(alpha_drop, groups = c( "wave","subscale"))


as_flextable(alpha_drop) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>% 
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")


```

\newpage

```{r summary_item_statistics, tab.cap = "Summary item statistics by each subscale", tab.id = "summary_item_statistics"}

item_stats = list()

for(i in 1:length(subscale_data)){
  
 item_stats[[i]] <- alpha(select(dat_s, all_of(subscale_data[[i]])))$item.stats
  
}

item_stats <- map_dfr(item_stats, bind_rows) %>% 
            round(digits = 3) %>%
            rownames_to_column("item") %>%
  left_join(subscale_item_name, by = "item") %>%
  select(subscale, everything())

item_stats <- as_grouped_data(item_stats, groups = c( "wave","subscale"))

as_flextable(item_stats) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")
```

\newpage

```{r item_total_statistics, tab.cap = "Item total statistics", tab.id = "item_total_statistics"}

total_stats = list()

for(i in 1:length(subscale_data)){
  
 total_stats[[i]] <- alpha(select(dat_s, all_of(subscale_data[[i]])))$total
  
}

total_stats <- map_dfr(total_stats, bind_rows) %>% 
            round(digits = 3) %>%
            mutate(subscale_wave = unique(
              paste(subscale_item_name$subscale,
                    gsub("^(T)([0-9])$","\\2",subscale_item_name$wave),
                    sep = "_"))
            ) %>%
  left_join(sup.cat(get.omega(model_lg_inv[[3]])), by = "subscale_wave") %>% # merge in omega squared 
   mutate(wave = gsub("(.*)(_)([0-9])", "\\3", subscale_wave),
         wave = paste("T", wave, sep = ""),
         subscale = gsub("(.*)(_)([0-9])", "\\1", subscale_wave)) %>%
  select(subscale, wave, omega, everything(), -subscale_wave)

total_stats <- as_grouped_data(total_stats, groups = c( "wave"))

as_flextable(total_stats) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>% 
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  set_table_properties(layout = "autofit")

```


\newpage


#### Measurement Invariance

```{r inv_tx, tab.cap = "Treatment group invariance model fit", tab.id = "inv_tx"}

df_inv_tx <- sup.cat(map_dfr(lapply(model_inv_tx, get.invariance), bind_rows))

df_inv_tx <- df_inv_tx %>%
  mutate(wave = gsub("^(.*)([0-9])_(.*)([0-9])_(.*)$", "\\2", Filename), .before = "Parameters") %>%
  mutate(wave = paste("T", wave, sep = ""))

df_inv_tx <- as_grouped_data(df_inv_tx, groups = c("wave"))


as_flextable(df_inv_tx) %>% 
  compose(
    part = "header", j = "ChiSqM_Value",
    value = as_paragraph("\U03C7",as_sup("2"))
    ) %>%
  compose(
    part = "header", j = "ChiSqBaseline_Value",
    value = as_paragraph("\U03C7",as_sup("2"), as_sub("B"))
    ) %>%
  compose(
    part = "header", j = "ChiSqDiffTest_Value",
    value = as_paragraph(paste("\u0394","\U03C7", sep = ""), as_sup("2"))
    ) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  italic(j = c(4,7,10), part = "header") %>%
  set_header_labels(
    Parameters = "k",
    ChiSqM_DF = "df",
    ChiSqM_PValue = "p",
    ChiSqBaseline_DF = "df",
    ChiSqBaseline_PValue = "p",
    ChiSqDiffTest_DF = "df",
    ChiSqDiffTest_PValue = "p",
    RMSEA_Estimate = "RMSEA"
  )  %>%
  set_table_properties(layout = "autofit")

```
\newpage
```{r inv_gender, tab.cap = "Gender invariance model fit", tab.id = "inv_gender"}

df_inv_gender <- sup.cat(map_dfr(lapply(model_inv_gender, get.invariance), bind_rows))

df_inv_gender <- df_inv_gender %>%
  mutate(wave = gsub("^(.*)([0-9])_(.*)([0-9])_(.*)$", "\\2", Filename), .before = "Parameters") %>%
  mutate(wave = paste("T", wave, sep = ""))

df_inv_gender <- as_grouped_data(df_inv_gender, groups = c("wave"))

as_flextable(df_inv_gender) %>% 
  compose(
    part = "header", j = "ChiSqM_Value",
    value = as_paragraph("\U03C7",as_sup("2"))
    ) %>%
  compose(
    part = "header", j = "ChiSqBaseline_Value",
    value = as_paragraph("\U03C7",as_sup("2"), as_sub("B"))
    ) %>%
  compose(
    part = "header", j = "ChiSqDiffTest_Value",
    value = as_paragraph(paste("\u0394","\U03C7", sep = ""), as_sup("2"))
    ) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  italic(j = c(4,7,10), part = "header") %>%
  set_header_labels(
    Parameters = "k",
    ChiSqM_DF = "df",
    ChiSqM_PValue = "p",
    ChiSqBaseline_DF = "df",
    ChiSqBaseline_PValue = "p",
    ChiSqDiffTest_DF = "df",
    ChiSqDiffTest_PValue = "p",
    RMSEA_Estimate = "RMSEA"
  )  %>%
  set_table_properties(layout = "autofit")

```
\newpage
```{r inv_age, tab.cap = "Age invariance model fit", tab.id = "inv_age"}

df_inv_age <- sup.cat(map_dfr(lapply(model_inv_age, get.invariance), bind_rows))

df_inv_age <- df_inv_age %>%
  mutate(wave = gsub("^(.*)([0-9])_(.*)([0-9])_(.*)$", "\\2", Filename), .before = "Parameters") %>%
  mutate(wave = paste("T", wave, sep = ""))

df_inv_age <- as_grouped_data(df_inv_age, groups = c("wave"))

as_flextable(df_inv_age) %>% 
  compose(
    part = "header", j = "ChiSqM_Value",
    value = as_paragraph("\U03C7",as_sup("2"))
    ) %>%
  compose(
    part = "header", j = "ChiSqBaseline_Value",
    value = as_paragraph("\U03C7",as_sup("2"), as_sub("B"))
    ) %>%
  compose(
    part = "header", j = "ChiSqDiffTest_Value",
    value = as_paragraph(paste("\u0394","\U03C7", sep = ""), as_sup("2"))
    ) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  italic(j = c(4,7,10), part = "header") %>%
  set_header_labels(
    Parameters = "k",
    ChiSqM_DF = "df",
    ChiSqM_PValue = "p",
    ChiSqBaseline_DF = "df",
    ChiSqBaseline_PValue = "p",
    ChiSqDiffTest_DF = "df",
    ChiSqDiffTest_PValue = "p",
    RMSEA_Estimate = "RMSEA"
  )  %>%
  set_table_properties(layout = "autofit")

```
\newpage
```{r inv_lg, tab.cap = "Longitudinal invariance model fit", tab.id = "inv_lg"}

df_inv_lg <- sup.cat(get.invariance(model_lg_inv))

flextable(df_inv_lg) %>% 
  compose(
    part = "header", j = "ChiSqM_Value",
    value = as_paragraph("\U03C7",as_sup("2"))
    ) %>%
  compose(
    part = "header", j = "ChiSqBaseline_Value",
    value = as_paragraph("\U03C7",as_sup("2"), as_sub("B"))
    ) %>%
  compose(
    part = "header", j = "ChiSqDiffTest_Value",
    value = as_paragraph(paste("\u0394","\U03C7", sep = ""), as_sup("2"))
    ) %>%
  align(part = "all") %>%
  font(fontname = "Times", part = "all") %>%
  bold(part = "header") %>%
  fontsize(size = 10, part = "body") %>% 
  italic(j = c(4,7,10), part = "header") %>%
  set_header_labels(
    Parameters = "k",
    ChiSqM_DF = "df",
    ChiSqM_PValue = "p",
    ChiSqBaseline_DF = "df",
    ChiSqBaseline_PValue = "p",
    ChiSqDiffTest_DF = "df",
    ChiSqDiffTest_PValue = "p",
    RMSEA_Estimate = "RMSEA"
  )  %>%
  set_table_properties(layout = "autofit")

```

<!---BLOCK_LANDSCAPE_STOP--->


## Reference

TBD...

